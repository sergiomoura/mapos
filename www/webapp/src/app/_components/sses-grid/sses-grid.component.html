<div class="container-80 top-gap padding">
	<div class="container-filtro">
	<app-buscador
			#buscador
			chaveDeBusca="buscaDoGrid"
			(ssesCarregadas)="onSsesCarregadas($event)"
			[equipes]="equipes"
			[bairros]="bairros"
			[auto]="true">
	</app-buscador>
</div>

<div class="resultados-container">
	<table class="tb-resultados">
		<thead>
			<tr>
				<td colspan="27">Dados da SSE</td>
				<td colspan="4">Dados do 1º Serviço</td>
				<td colspan="4">Dados do 2º Serviço</td>
			</tr>
			<tr>
				<td>ID</td>
				<td>Status</td>
				<td>Nº SSE</td>
				<td>Data Recebimento SSE</td>
				<td>Nº Domasa</td>
				<td>Endereço</td>
				<td>ID Bairro</td>
				<td>Nome Bairro</td>
				<td>Obs</td>
				<td>Agendado para</td>
				<td>Realizado em</td>
				<td>Tot Medidas Prev</td>
				<td>Tot Medidas Real</td>
				<td>Dif. Medidas</td>
				<td>Divergência?</td>
				<td>TDS Prev</td>
				<td>TDS Real</td>
				<td>Dif. TDS</td>
				<td>Classificação</td>
				<td>Classificação (Alteração)</td>
				<td>Prioridade</td>
				<td>DL Execução</td>
				<td>Data Devolução</td>
				<td>DL Garantia</td>
				<td>Em Garantia?</td>
				<td>Cálculo Execução</td>
				<td>Valor da SSE</td>
				<td>Equipe</td>
				<td>Apoio</td>
				<td>Data da Execução</td>
				<td>Consumo</td>
				<td>Equipe</td>
				<td>Apoio</td>
				<td>Data da Execução</td>
				<td>Consumo</td>
			</tr>
		</thead>
		<tbody *ngFor="let sse of sses">
			<tr>
				<td>{{sse.id}}</td>
				<td>{{sse.status}}</td>
				<td>{{sse.numero}}</td>
				<td>{{sse.dh_recebido | date:"dd/MM/yyyy"}}</td>
				<td>{{sse.bairro.domasa}}</td>
				<td>{{sse.endereco}}</td>
				<td>{{sse.bairro?.codigo}}</td>
				<td>{{sse.bairro?.nome}}</td>
				<td>{{sse.obs}}</td>
				<td>{{sse.inicio_p | date:"dd/MM/yyyy"}}</td>
				<td>{{sse.final_r | date:"dd/MM/yyyy"}}</td>
				<td>{{getTotalPrev(sse).toString()}}</td>
				<td>{{ (sse.tipoDeServicoReal != undefined) ? getTotalReal(sse).toString() : ''}}</td>
				<td>{{sse.dif_medidas}}</td>
				<td>{{sse.label_divergencia}}</td>
				<td>{{sse.tipoDeServicoPrev?.codigo}}</td>
				<td>{{sse.tipoDeServicoReal?.codigo}}</td>
				<td>{{sse.label_dif_tds}}</td>
				<td>{{sse.faixaPrev?.label}} ({{sse.faixaPrev?.li}} < X {{ +sse.faixaPrev?.ls == infinito ? '' : '≤ ' + sse.faixaPrev?.ls}})</td>
				<td>{{sse.faixa_real_label}}</td>
				<td>{{sse.label_urgencia}}</td>
				<td>{{sse.prazoFinal | date:'dd/MM/yyyy'}}</td>
				<td>{{sse.label_data_devolucao}}</td>
				<td>{{sse.label_dl_garantia}}</td>
				<td>{{sse.label_em_garantia}}</td>
				<td>{{sse.calc_exec}}</td>
				<td>{{sse.valor_real | currency:'BRL':symbol:'1.2-2' | moedaBrasil}}</td>
				<td>{{sse.tarefas.length > 0 && sse.tarefas[0].equipe ? sse.tarefas[0].equipe.nome : ''}}</td>
				<td>{{sse.tarefas.length > 0 && sse.tarefas[0].apoio ? sse.tarefas[0].apoio.nome : ''}}</td>
				<td>{{sse.tarefas.length > 0 && sse.tarefas[0].final_r ? (sse.tarefas[0].final_r|date:'dd/MM/yyyy') : ''}}</td>
				<td>
					<ul *ngIf="sse.tarefas.length > 0 && sse.tarefas[0].consumos.length > 0">
						<li *ngFor="let c of sse.tarefas[0].consumos">
							{{c.nome}} : {{c.qtde}} {{c.unidade}}
						</li>
					</ul>
				</td>
				<td>{{sse.tarefas.length > 1 && sse.tarefas[1].equipe ? sse.tarefas[1].equipe.nome : ''}}</td>
				<td>{{sse.tarefas.length > 1 && sse.tarefas[1].apoio ? sse.tarefas[1].apoio.nome : ''}}</td>
				<td>{{sse.tarefas.length > 1 && sse.tarefas[1].final_r ? (sse.tarefas[1].final_r|date:'dd/MM/yyyy') : ''}}</td>
				<td>
					<ul *ngIf="sse.tarefas.length > 1 && sse.tarefas[1].consumos.length > 1">
						<li *ngFor="let c of sse.tarefas[1].consumos">
							{{c.nome}} : {{c.qtde}} {{c.unidade}}
						</li>
					</ul>
				</td>
			</tr>
			
		</tbody>
	</table>
</div>
